<!-- Copyright (C) 2020-2022 Oleksandr Masniuk -->
<!-- SPDX-License-Identifier: AGPL-3.0-or-later -->

<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org">
<head>
    <title>App</title>
</head>
<body>
<th:block th:fragment="modal-essential">
    <!-- Modal error-->
    <div class="modal fade c-no-history" id="error-generation" tabindex="-1" role="dialog" aria-labelledby="error-generation-title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="error-generation-title">Generation error</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    An error has occurred while generating your ladder.
                    <div id="error-generation-text" class="text-danger"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal session-->
    <div class="modal fade c-no-history" id="error-session" tabindex="-1" role="dialog" aria-labelledby="error-session-title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="error-session-title">Session expired</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Your session has expired. It will be renewed automatically.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal update app-->
    <div class="modal fade c-no-history" id="application-version-update" tabindex="-1" role="dialog" aria-labelledby="application-version-update-title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="application-version-update-title">Updating application
                        <span class="align-self-center spinner-border text-primary" role="status" aria-hidden="true"></span></h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    A new application version has been released. We need to update your local version before you can continue
                    using the website. Please reload the page if nothing happens in 10 seconds.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal confirm action -->
    <div class="modal fade c-no-history" id="modal-confirmation" tabindex="-1" role="dialog" aria-labelledby="modal-confirmation-title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="modal-confirmation-title">Confirmation</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p class="description"></p>
                    <p>Type "<span class="requirement"></span>" to confirm the action.</p>
                    <form id="modal-confirmation-form">
                        <input id="modal-confirmation-input" class="form-control" type="text" autocomplete="off"/>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="submit" form="modal-confirmation-form" class="btn btn-action" disabled="disabled"></button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</th:block>
<th:block th:fragment="modal ()">
    <th:block th:replace="~{fragments/app::modal-essential}"></th:block>
    <div class="modal fade c-no-history" id="report-character-modal" tabindex="-1" role="dialog" aria-labelledby="report-character-modal-title" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title" id="report-character-modal-title">Report player</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="report-character-menu">
                        <div>
                            The reports are public, <strong class="text-danger">your BattleTag and description will be visible to all users</strong>.
                            Moderators will review the report and vote on it, the majority wins. Moderators:
                            <span th:text="${@userController.getModTags().stream().collect(T(java.util.stream.Collectors).joining(', '))}"></span>
                        </div>
                        <form id="report-character-form" class="px-4 py-3" method="post">
                            <div class="form-group">
                                <label for="report-character-type">Report for</label>
                                <select id="report-character-type" class="form-control text-center" name="type" required="required">
                                    <option value="CHEATER" selected="selected">Cheating</option>
                                    <option value="LINK">Multiacc</option>
                                </select>
                            </div>
                            <div id="report-character-additional-group" class="form-group d-none">
                                <label for="report-character-additional">Alt account(populated from the team buffer, "green plus" button)</label>
                                <select id="report-character-additional" class="form-control text-center"  name="additionalPlayerCharacterId" required="required" disabled="disabled">
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="report-character-evidence">
                                    Evidence. <strong class="text-danger">Please read the
                                    <a th:href="${@environment.getProperty('com.nephest.battlenet.sc2.player.complaint.policy.link')}" rel="noopener" target="_blank">player complaint policy</a>
                                    before reporting a player. Invalid reports will be removed.</strong>
                                </label>
                                <textarea
                                        id="report-character-evidence"
                                        class="form-control text-center"
                                        name="evidence"
                                        th:maxlength="${T(com.nephest.battlenet.sc2.model.local.Evidence).MAX_LENGTH}"
                                        minLength="10"
                                        required="required"></textarea>
                            </div>
                            <button type="submit" class="btn btn-primary">Report</button>
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal player info-->
    <div
            class="modal fade no-popup d-none"
            id="player-info"
            aria-labelledby="player-info-title"
            aria-hidden="true"
            data-view-name="character"
    >
        <div class="modal-dialog modal-complex modal-xl" >
            <div class="modal-content">
                <div class="modal-header">
                    <button class="close close-left" type="button" aria-label="Back">
                        <span aria-hidden="true">&lArr;</span>
                    </button>
                    <h2 class="modal-title" id="player-info-title">
                        <a id="player-info-title-clan" class="clan-auto-search player-team"></a>
                        <span id="player-info-title-team" class="player-team"></span>
                        <span id="player-info-title-name"></span>
                        <span id="player-info-additional-container">
                            <span class="text-secondary">(</span>
                                <a id="player-info-title-clan-additional" class="clan-auto-search player-team"></a>
                                <span id="player-info-title-name-additional" class="text-secondary"></span>
                            <span class="text-secondary">)</span>
                        </span>
                    </h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <nav>
                        <ul id="player-stats-tabs" class="nav nav-fill nav-pills mb-3 justify-content-center" role="tablist">
                            <li class="nav-item">
                                <a
                                        id="player-stats-summary-tab"
                                        class="nav-link"
                                        data-toggle="pill"
                                        data-target="#player-stats-summary"
                                        href="#player-stats-summary"
                                        role="tab"
                                        aria-controls="player-stats-summary"
                                        aria-selected="false"
                                >
                                    Summary
                                </a>
                            </li>
                            <li class="nav-item">
                                <a
                                        id="player-stats-mmr-tab"
                                        class="nav-link active"
                                        data-toggle="pill"
                                        data-target="#player-stats-mmr"
                                        href="#player-stats-mmr"
                                        role="tab"
                                        aria-controls="player-stats-mmr"
                                        aria-selected="true"
                                >
                                    MMR
                                </a>
                            </li>
                            <li class="nav-item">
                                <a
                                        id="player-stats-history-tab"
                                        class="nav-link"
                                        data-toggle="pill"
                                        data-target="#player-stats-history"
                                        href="#player-stats-history"
                                        role="tab"
                                        aria-controls="player-stats-history"
                                        aria-selected="false"
                                >
                                    Teams
                                </a>
                            </li>
                            <li class="nav-item">
                                <a
                                        id="player-stats-characters-tab"
                                        class="nav-link"
                                        data-toggle="pill"
                                        data-target="#player-stats-characters"
                                        href="#player-stats-characters"
                                        role="tab"
                                        aria-controls="player-stats-characters"
                                        aria-selected="false"
                                >
                                    Characters
                                </a>
                            </li>
                            <li class="nav-item">
                                <a
                                        id="player-stats-matches-tab"
                                        class="nav-link"
                                        data-toggle="pill"
                                        data-target="#player-stats-matches"
                                        href="#player-stats-matches"
                                        role="tab"
                                        aria-controls="player-stats-matches"
                                        aria-selected="false"
                                >
                                    Matches
                                </a>
                            </li>
                            <li class="nav-item">
                                <a
                                        id="player-stats-player-tab"
                                        class="nav-link"
                                        data-toggle="pill"
                                        data-target="#player-stats-player"
                                        href="#player-stats-player"
                                        role="tab"
                                        aria-controls="player-stats-player"
                                        aria-selected="false"
                                >
                                    Links
                                </a>
                            </li>
                        </ul>
                    </nav>
                    <div id="player-stats-all" class="tab-content">
                        <section id="player-stats-summary" class="tab-pane fade" data-view-title="Summary">
                            <section id="player-stats">
                                <h3>
                                    Career summary
                                    <img
                                            th:src="@{/static/icon/misc/info.svg}"
                                            alt="Highest MMR, league, and total games played for all seasons."
                                            title="Highest MMR, league, and total games played for all seasons."
                                            data-toggle="tooltip"
                                    />
                                </h3>
                                <div id="player-stats-container" class="card-deck"></div>
                                <aside>
                                    <p class="text-secondary">
                                        Race specific statistics are based on the teams where the player has played
                                        most of the games as a specific race
                                    </p>
                                </aside>
                            </section>
                        </section>
                        <section id="player-stats-mmr" class="tab-pane fade show active" data-view-title="MMR history">
                            <section id="character-mmr-section">
                                <h3>Solo MMR history
                                    <span class="fullscreen-toggle align-middle" data-target="player-stats-mmr"></span></h3>

                                <div id="mmr-history-info-panel" class="flex-col-adaptive adaptive-border-color-splitter">
                                <div class="border-splitter-right adaptive-border-color-splitter">
                                <div><div id="mmr-history-filters"></div><div id="mmr-history-games-avg-mmr"></div></div>
                                <div th:replace="~{fragments/section:: form-mmr-history('mmr', true)}"></div>
                                </div>
                                <div class="table-responsive">
                                    <table id="mmr-summary-table" class="table inline-table table-sm table-hover">
                                        <thead>
                                        <tr>
                                            <th scope="col">Race</th>
                                            <th scope="col">Games</th>
                                            <th scope="col">Last MMR</th>
                                            <th scope="col">Avg MMR</th>
                                            <th scope="col">Max MMR</th>
                                        </tr>
                                        </thead>
                                        <tbody></tbody>
                                    </table>
                                </div>
                                </div>
                                <table
                                        id="mmr-table"
                                        class="chartable"
                                        data-chart-type="line"
                                        data-chart-group="mmr"
                                        data-chart-tooltip-percentage="false"
                                        data-chart-tooltip-table-headers="Race,Season,League,MMR,Games/W%,Global Rank,Region rank,League rank"
                                        data-chart-id="mmr-chart"
                                        data-chart-x-title="Date" data-chart-y-title="MMR"
                                        data-chart-performance="fast"
                                        data-chart-point-radius="0.5"
                                        data-chart-x-type="time"
                                        data-chart-x-time-unit="false"
                                        data-chart-direct="true"
                                        data-chart-zoom="xy"
                                >
                                    <thead><tr></tr></thead>
                                    <tbody><tr></tr></tbody>
                                </table>
                                <div id="mmr-chart-container" class="container-chart"><canvas id="mmr-chart" class="c-chart"></canvas></div>
                            </section>
                        </section>
                        <section id="player-stats-history" class="tab-pane fade" data-view-title="Teams">
                            <section id="character-teams-section">
                                <h3>Teams</h3>
                                <select id="teams-season-select" class="form-control mb-2 text-center"></select>
                            </section>
                        </section>
                        <section id="player-stats-characters" class="tab-pane fade" data-view-title="Linked characters">
                            <div th:replace="~{fragments/table :: player-search('linked-characters-table', 'Linked characters', 'table-selectable-row')}"></div>
                            <p th:replace="~{fragments/section :: missing-characters-message}"></p>
                        </section>
                        <section id="player-stats-player" class="tab-pane fade" data-view-title="Player info">
                            <section id="pro-player-info" class="pro-player-info">
                                <h3>Pro player info</h3>
                                <table class="table c-table-simple m-auto">
                                    <tbody>
                                    <tr id="pro-player-name" class="pro-player-info"><th scope="row">Name</th><td></td></tr>
                                    <tr id="pro-player-birthday" class="pro-player-info"><th scope="row">Birthday</th><td></td></tr>
                                    <tr id="pro-player-country" class="pro-player-info"><th scope="row">Country</th><td></td></tr>
                                    <tr id="pro-player-team" class="pro-player-info"><th scope="row">Team</th><td></td></tr>
                                    <tr id="pro-player-earnings" class="pro-player-info"><th scope="row">Earnings</th><td></td></tr>
                                    </tbody>
                                </table>
                            </section>
                            <section>
                                <h3>Links</h3>
                                <ul class="list-unstyled text-center">
                                    <li class="mb-3">
                                        <ul class="d-flex flex-center-wrap-gap list-unstyled">
                                            <li class="pro-player-info">
                                                <a id="link-liquipedia" class="social-media" href="#" target="_blank" rel="noopener">
                                                    <img th:src="@{/static/icon/logo/liquipedia.svg}" alt="Liquipedia"/>
                                                </a>
                                            </li>
                                            <li class="pro-player-info">
                                                <a id="link-aligulac" class="social-media" href="#" target="_blank" rel="noopener">
                                                    &sum;
                                                </a>
                                            </li>
                                            <li class="pro-player-info">
                                                <a id="link-instagram" class="social-media" href="#" target="_blank" rel="noopener">
                                                    <img th:src="@{/static/icon/logo/instagram.svg}" alt="Instagram"/>
                                                </a>
                                            </li>
                                            <li class="pro-player-info">
                                                <a id="link-twitter" class="social-media" href="#" target="_blank" rel="noopener">
                                                    <img th:src="@{/static/icon/logo/twitter.svg}" alt="Twitter"/>
                                                </a>
                                            </li>
                                            <li class="pro-player-info">
                                                <a id="link-twitch" class="social-media" href="#" target="_blank" rel="noopener">
                                                    <img th:src="@{/static/icon/logo/twitch.svg}" alt="Twitch"/>
                                                </a>
                                            </li>
                                            <li class="pro-player-info">
                                                <a id="link-youtube" class="social-media" href="#" target="_blank" rel="noopener">
                                                    <img th:src="@{/static/icon/logo/youtube.svg}" alt="Youtube"/>
                                                </a>
                                            </li>
                                            <li class="pro-player-info">
                                                <a id="link-discord" class="social-media" href="#" target="_blank" rel="noopener">
                                                    <img th:src="@{/static/icon/logo/discord.svg}" alt="Discord"/>
                                                </a>
                                            </li>
                                            <li>
                                                <a id="link-sc2" class="social-media" href="#" target="_blank" rel="noopener">
                                                    <img th:src="@{/static/icon/logo/sc2.svg}" alt="SC2"/>
                                                </a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="mb-3">
                                        <ul class="d-inline-flex flex-column flex-center-wrap-gap list-unstyled flex-list">
                                            <li>
                                                <span id="link-battletag" class="social-media d-flex flex-center-wrap-gap">
                                                    <img th:src="@{/static/icon/logo/battlenet.svg}" alt="BattleTag" title="BattleTag" class="flex-grow-1"/>
                                                    <span class="tag copy-to-clipboard text-right"></span>
                                                </span>
                                            </li>
                                            <li>
                                                <span id="link-discord-connection" class="social-media d-flex flex-center-wrap-gap">
                                                    <img th:src="@{/static/icon/logo/discord.svg}" alt="Discord" title="Discord" class="flex-grow-1"/>
                                                    <span class="tag copy-to-clipboard text-right"></span>
                                                </span>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </section>
                            <section id="revealed-report">
                                <ul class="d-inline-block">
                                    <li th:insert="~{/fragments/section :: missing-battle-tag-message}"></li>
                                    <li>Dou you know which pro player plays on this account? Please
                                        <a href="https://nephest.com/#contacts" target="_blank" rel="noopener">contact me</a>.
                                    </li>
                                    <li>Found incorrect information in the "pro player info"/"links" section? Report this to
                                        <a href="http://aligulac.com/" rel="noopener nofollow" target="_blank">aligulac</a> or
                                        <a href="https://nephest.com/#contacts" target="_blank" rel="noopener">contact me</a>.
                                    </li>
                                </ul>
                            </section>
                            <section id="character-reports" class="d-none">
                                <h3>Reports</h3>
                                <div th:replace="~{fragments/table :: reports-character('character-reports-table-container', 'character-reports-table', '')}"></div>
                            </section>
                        </section>
                        <section id="player-stats-matches" class="tab-pane fade" data-view-title="Matches">
                            <div th:replace="~{/fragments/section :: matches('', true)}"></div>
                        </section>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="follow-button" type="button" class="btn btn-primary d-none">Follow</button>
                    <button id="unfollow-button" type="button" class="btn btn-primary d-none">Unfollow</button>
                    <button class="btn btn-danger" type="button" id="report-character-toggle" data-toggle="modal" data-target="#report-character-modal">Report</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div th:replace="~{fragments/section :: modal-no-popup('versus-modal', 'Versus', ~{fragments/no-tab :: no-tab-short ('versus', 'Versus', ~{fragments/versus :: versus}, false)})}"></div>
    <div id="status-generating-fullscreen" class="status-generating-begin position-absolute w-100 h-100 invisible" data-hide-mode="hide">
        <div class="d-flex justify-content-center w-100 h-100">
            <span class="align-self-center spinner-border text-primary" role="status" aria-hidden="true"></span>
        </div>
    </div>
    <div id="team-buffer" class="d-none sticky-bottom border-top border-primary" data-view-name="team-buffer">
        <h2 class="mt-2 d-flex justify-content-end flex-wrap-reverse gap-1">
            <a id="team-buffer-collapse" class="c-dropdown c-dropup collapsed flex-grow-1" href="#team-buffer-top-container"
               data-toggle="collapse" role="button" aria-expanded="false" aria-controls="team-buffer-top-container">
                Buffer(<span id="team-buffer-count"></span> teams, <span id="team-buffer-clan-count"></span> clans)
            </a>
            <span class="d-flex gap-1">
                <div class="dropup">
                     <span id="team-buffer-copy"
                           class="table-image table-image-square vertical-align-initial background-cover clipboard-img d-inline-block dropdown-toggle dropdown-toggle-no-symbol"
                           role="button"
                           title="Copy to clipboard"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-boundary="body">
                        <span class="sr-only">Copy to clipboard</span>
                    </span>
                    <div class="dropdown-menu dropdown-menu-right" aria-labelledby="team-buffer-copy">
                        <a id="team-buffer-copy-character-id" class="dropdown-item action-team" href="#">characterId</a>
                        <a id="team-buffer-copy-legacy-id" class="dropdown-item action-team" href="#">legacyId</a>
                        <a id="team-buffer-copy-character-race-id" class="dropdown-item action-team" href="#">raceId</a>
                        <a id="team-buffer-copy-clan-id" class="dropdown-item" href="#">clanId</a>
                    </div>
                </div>
                <a id="team-buffer-versus" href="#" rel="noopener" target="_blank" class="font-weight-bold d-inline-block" role="button">
                    VS
                </a>
                <a id="team-buffer-mmr" href="#" rel="noopener" target="_blank" class="table-image table-image-square background-cover chart-line-img d-inline-block" role="button">
                    <span class="sr-only">MMR</span>
                </a>
                <span id="team-buffer-clear" class="table-image table-image-square background-cover cross-img d-inline-block" role="button">
                    <span class="sr-only">Clear</span>
                </span>
            </span>
        </h2>
        <div id="team-buffer-top-container" class="collapse">
            <div th:replace="~{fragments/table :: team('team-buffer-container', 'team-buffer-teams', 'd-none', 'true')}"></div>
            <div data-view-name="clan-buffer">
                <div th:replace="~{fragments/table :: clan ('team-buffer-clan-container', 'team-buffer-clans', 'd-none')}"></div>
            </div>
        </div>
    </div>
</th:block>
</body>
</html>
